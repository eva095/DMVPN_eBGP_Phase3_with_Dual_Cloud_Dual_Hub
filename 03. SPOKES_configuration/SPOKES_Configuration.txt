

R3(SPOKE):

hostname R3
!
vrf definition DATA
 rd 3009:500
 !
 address-family ipv4
 exit-address-family
!
vrf definition ISP-1
 rd 3009:100
 !
 address-family ipv4
 exit-address-family
!
vrf definition ISP-2
 rd 3009:200
 !
 address-family ipv4
 exit-address-family
!
interface Loopback0
 ip address 3.3.3.3 255.255.255.255
!
interface Tunnel1
 vrf forwarding DATA
 ip address 10.1.0.3 255.255.255.0
 no ip redirects
 ip nhrp authentication MyNet
 ip nhrp map 10.1.0.1 172.16.1.1
 ip nhrp map multicast 172.16.1.1
 ip nhrp map 10.1.0.2 172.16.2.2
 ip nhrp map multicast 172.16.2.2
 ip nhrp network-id 100
 ip nhrp nhs 10.1.0.1
 ip nhrp nhs 10.1.0.2
 tunnel source GigabitEthernet0/1
 tunnel mode gre multipoint
 tunnel vrf ISP-1
!
interface Tunnel2
 vrf forwarding DATA
 ip address 10.2.0.3 255.255.255.0
 no ip redirects
 ip nhrp authentication MyNet
 ip nhrp map 10.2.0.1 172.20.1.1
 ip nhrp map multicast 172.20.1.1
 ip nhrp map 10.2.0.2 172.20.2.2
 ip nhrp map multicast 172.20.2.2
 ip nhrp network-id 200
 ip nhrp nhs 10.2.0.1
 ip nhrp nhs 10.2.0.2
 tunnel source GigabitEthernet0/2
 tunnel mode gre multipoint
 tunnel vrf ISP-2
!
interface GigabitEthernet0/1
 vrf forwarding ISP-1
 ip address 172.16.3.3 255.255.255.0
 duplex auto
 speed auto
 media-type rj45
!
interface GigabitEthernet0/2
 vrf forwarding ISP-2
 ip address 172.20.3.3 255.255.255.0
 duplex auto
 speed auto
 media-type rj45
!
interface GigabitEthernet0/3
 vrf forwarding DATA
 ip address 10.3.4.3 255.255.255.0
 duplex auto
 speed auto
 media-type rj45
!
router bgp 3009
 bgp router-id 3.3.3.3
 bgp log-neighbor-changes
 bgp bestpath as-path multipath-relax
 !
 address-family ipv4 vrf DATA
  network 3.3.3.3 mask 255.255.255.255
  network 10.3.4.0 mask 255.255.255.0
  neighbor 10.1.0.1 remote-as 19
  neighbor 10.1.0.1 activate
  neighbor 10.1.0.2 remote-as 19
  neighbor 10.1.0.2 activate
  neighbor 10.2.0.1 remote-as 19
  neighbor 10.2.0.1 activate
  neighbor 10.2.0.2 remote-as 19
  neighbor 10.2.0.2 activate
  maximum-paths 5
 exit-address-family
 !
 address-family ipv4 vrf ISP-1
  neighbor 172.16.3.100 remote-as 100
  neighbor 172.16.3.100 activate
 exit-address-family
 !
 address-family ipv4 vrf ISP-2
  neighbor 172.20.3.200 remote-as 200
  neighbor 172.20.3.200 activate
 exit-address-family


\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\


R5(SPOKE):

hostname R5
!
vrf definition DATA
 rd 3009:500
 !
 address-family ipv4
 exit-address-family
!
vrf definition ISP-1
 rd 3009:100
 !
 address-family ipv4
 exit-address-family
!
vrf definition ISP-2
 rd 3009:200
 !
 address-family ipv4
 exit-address-family
!
!
interface Loopback0
 ip address 5.5.5.5 255.255.255.255
!
interface Tunnel1
 vrf forwarding DATA
 ip address 10.1.0.5 255.255.255.0
 no ip redirects
 ip nhrp authentication MyNet
 ip nhrp map 10.1.0.1 172.16.1.1
 ip nhrp map multicast 172.16.1.1
 ip nhrp map 10.1.0.2 172.16.2.2
 ip nhrp map multicast 172.16.2.2
 ip nhrp network-id 100
 ip nhrp nhs 10.1.0.1
 ip nhrp nhs 10.1.0.2
 tunnel source GigabitEthernet0/2
 tunnel mode gre multipoint
 tunnel vrf ISP-1
!
interface Tunnel2
 vrf forwarding DATA
 ip address 10.2.0.5 255.255.255.0
 no ip redirects
 ip nhrp authentication MyNet
 ip nhrp map 10.2.0.1 172.20.1.1
 ip nhrp map multicast 172.20.1.1
 ip nhrp map 10.2.0.2 172.20.2.2
 ip nhrp map multicast 172.20.2.2
 ip nhrp network-id 200
 ip nhrp nhs 10.2.0.1
 ip nhrp nhs 10.2.0.2
 tunnel source GigabitEthernet0/3
 tunnel mode gre multipoint
 tunnel vrf ISP-2
!
interface GigabitEthernet0/0
 vrf forwarding DATA
 ip address 10.0.5.5 255.255.255.0
 duplex auto
 speed auto
 media-type rj45
!
interface GigabitEthernet0/2
 vrf forwarding ISP-1
 ip address 172.16.5.5 255.255.255.0
 duplex auto
 speed auto
 media-type rj45
!
interface GigabitEthernet0/3
 vrf forwarding ISP-2
 ip address 172.20.5.5 255.255.255.0
 duplex auto
 speed auto
 media-type rj45
!
router bgp 3009
 bgp router-id 5.5.5.5
 bgp log-neighbor-changes
 bgp bestpath as-path multipath-relax
 !
 address-family ipv4 vrf DATA
  network 5.5.5.5 mask 255.255.255.255
  network 10.0.5.0 mask 255.255.255.0
  neighbor 10.1.0.1 remote-as 19
  neighbor 10.1.0.1 activate
  neighbor 10.1.0.2 remote-as 19
  neighbor 10.1.0.2 activate
  neighbor 10.2.0.1 remote-as 19
  neighbor 10.2.0.1 activate
  neighbor 10.2.0.2 remote-as 19
  neighbor 10.2.0.2 activate
  maximum-paths 5
 exit-address-family
 !
 address-family ipv4 vrf ISP-1
  neighbor 172.16.5.100 remote-as 100
  neighbor 172.16.5.100 activate
 exit-address-family
 !
 address-family ipv4 vrf ISP-2
  neighbor 172.20.5.200 remote-as 200
  neighbor 172.20.5.200 activate
 exit-address-family



\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\


R6(SPOKE):

hostname R6
!
!
vrf definition DATA
 rd 3009:500
 !
 address-family ipv4
 exit-address-family
!
vrf definition ISP-1
 rd 3009:100
 !
 address-family ipv4
 exit-address-family
!
!
interface Loopback0
 ip address 6.6.6.6 255.255.255.255
!
interface Tunnel1
 vrf forwarding DATA
 ip address 10.1.0.6 255.255.255.0
 no ip redirects
 ip nhrp authentication MyNet
 ip nhrp map 10.1.0.1 172.16.1.1
 ip nhrp map multicast 172.16.1.1
 ip nhrp map 10.1.0.2 172.16.2.2
 ip nhrp map multicast 172.16.2.2
 ip nhrp network-id 100
 ip nhrp nhs 10.1.0.1
 ip nhrp nhs 10.1.0.2
 tunnel source GigabitEthernet0/3
 tunnel mode gre multipoint
 tunnel vrf ISP-1
!
interface GigabitEthernet0/0
 vrf forwarding DATA
 ip address 10.0.6.6 255.255.255.0
 duplex auto
 speed auto
 media-type rj45
!
interface GigabitEthernet0/3
 vrf forwarding ISP-1
 ip address 172.16.6.6 255.255.255.0
 duplex auto
 speed auto
 media-type rj45
!

router bgp 3009
 bgp router-id 6.6.6.6
 bgp bestpath as-path multipath-relax
 !
 address-family ipv4 vrf DATA
  network 6.6.6.6 mask 255.255.255.255
  network 10.0.6.0 mask 255.255.255.0
  neighbor 10.1.0.1 remote-as 19
  neighbor 10.1.0.1 activate
  neighbor 10.1.0.2 remote-as 19
  neighbor 10.1.0.2 activate
  maximum-paths 5
 exit-address-family
 !
 address-family ipv4 vrf ISP-1
  neighbor 172.16.6.100 remote-as 100
  neighbor 172.16.6.100 activate
 exit-address-family
!
address-family ipv4 vrf ISP-2
  neighbor 172.20.5.200 remote-as 200
  neighbor 172.20.5.200 activate
 exit-address-family
